#define PIEZO_PIN 9
const int trigger = 6;
const int echo = 7;

float previous_distance = 0.0;
const float change_threshold = 10.0; 

void setup() {
  Serial.begin(9600);
  pinMode(trigger, OUTPUT);
  pinMode(echo, INPUT);
  pinMode(PIEZO_PIN, OUTPUT);
}

void loop() {
  float current_distance = getDistance(trigger, echo);

  if (current_distance > 2 && current_distance < 100) { 
    float depth_change = abs(current_distance - previous_distance);

    if (depth_change > change_threshold) {
      tone(PIEZO_PIN, 475);
      delay(200);
      noTone(PIEZO_PIN);
      delay(100); 
    }

    previous_distance = current_distance; 
  }

  Serial.print("Depth Distance: ");
  Serial.print(current_distance);
  Serial.println(" in");

  delay(50);
}

float getDistance(int trigPin, int echoPin) {
  digitalWrite(trigPin, LOW);
  delayMicroseconds(5);
  digitalWrite(trigPin, HIGH);
  delayMicroseconds(10);
  digitalWrite(trigPin, LOW);

  long duration = pulseIn(echoPin, HIGH, 38000);
  return duration * 0.0135; 
}
